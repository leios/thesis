%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
% Modified by Jeremie Gillet in November 2015 to make an OIST Skill Pill template
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------

\documentclass{beamer}

\mode<presentation> {

\usetheme{}

\definecolor{OISTcolor}{rgb}{0.65,0.16,0.16}
\usecolortheme[named=OISTcolor]{structure}

%\setbeamertemplate{footline} % To remove the footer line in all slides uncomment this line
%\setbeamertemplate{footline}[page number] % To replace the footer line in all slides with a simple slide count uncomment this line

\setbeamertemplate{navigation symbols}{} % To remove the navigation symbols from the bottom of all slides uncomment this line
}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables
\usepackage{textpos} % Use for positioning the Skill Pill logo
\usepackage{fancyvrb}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{movie15}
%\usepackage{multimedia}
\usepackage{xcolor}
\usepackage{braket}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\setbeamertemplate{frametitle}[default][center]

\lstset{frame=tb,
  language=python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[PhD presentation]{Massively parallel split step Fourier techniques for simulating quantum systems} % The short title appears at the bottom of every slide, the full title is only on the title page

\author{James Schloss} % Your name
\institute[OIST] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Okinawa Institute of Science and Technology \\ % Your institution for the title page
\textit{james.schloss@oist.jp}
}
\date{December 9, 2019} % Date, can be changed to a custom date

\begin{document}

\setbeamertemplate{background}{\includegraphics[width=\paperwidth]{OISTBG.png}} % Adding the background logo

\begin{frame}
\vspace*{1.4cm}
\titlepage % Print the title page as the first slide
\end{frame}


\setbeamertemplate{background}{} % No background logo after title frame

\addtobeamertemplate{frametitle}{}{% Adding the Skill Pill logo on the title screen after title frame
\begin{textblock*}{100mm}(.92\textwidth,-0.75cm)
\includegraphics[height=1cm]{OIST}
\end{textblock*}}

\begin{frame}
\frametitle{Overview}
This project has created fast, GPU-accelerated software for the simulation of superfluid systems
\begin{columns}
\column{0.7\textwidth}
\begin{itemize}
\onslide<2->
\item The split-step Fourier method
\onslide<3->
\item Quantum state engineering
\onslide<4->
\item GPU architecture and the GPUE codebase
\onslide<5->
\item Chaotic vortex dynamics in a few-vortex system
\onslide<6->
\item Vortex rings with artificial magnetic fields
\onslide<7->
\item Conclusions and future directions
\end{itemize}
\column{0.3\textwidth}
\onslide<1->
\includegraphics<1>[width=\textwidth]{GPUE.png}
\includegraphics<2>[width=\textwidth]{../data/splitop/method/split_op_method.pdf}
\includegraphics<3>[width=\textwidth]{../data/1d/scheme.pdf}
\includegraphics<4>[width=\textwidth]{v100.png}
\includegraphics<5>[width=\textwidth]{../data/2d/evolution/evolution.pdf}
\includegraphics<6>[width=\textwidth]{../data/3d/HE21_3d.png}
\end{columns}
\end{frame}

\begin{frame}
\center \huge The split-step Fourier method
\end{frame}

\begin{frame}
\frametitle{Heisenberg uncertainty principle}
\center Position and momentum space are conjugate variables
$$
\sigma_x\sigma_p \geq \frac{\hbar}{2}
$$

\pause

%\movie[poster,width=0.6\textwidth, autostart, loop]{}{gaussian.mp4}
\center \includemovie[autoplay,loop]{5.33cm}{3cm}{gaussian.mp4}

We can flip between spaces with a Fourier transform
\end{frame}

\begin{frame}
\frametitle{The Fourier Transform}

\begin{columns}
\onslide<1->
\column{0.5\textwidth}
Fourier Transform:
\begin{align*}
F(\xi) &= \int_{-\infty}^{\infty}f(x)e^{2\pi i x \xi}dx\\
f(x) &= \int_{-\infty}^{\infty}F(\xi)e^{-2\pi i x \xi}d\xi
\end{align*}

\onslide<3->
Discrete Fourier Transform:
\begin{align*}
X_k &= \sum_{n=0}^{N-1} x_ne^{2\pi i k x / N}\\
x_n &= \sum_{k=0}^{N-1} X_ke^{-2\pi i k x / N}
\end{align*}

\onslide<4->
This is a \textit{global} operation requiring matrix multiplications
\column{0.5\textwidth}
\onslide<2->
\includegraphics[width=\textwidth]{time_0066.png}
\includegraphics[width=\textwidth]{freq_0066.png}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Cooley-Tukey}

\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item Recursively subdivides DFT into simple sums with twiddle factors
\item Many known libraries, like FFTW, and CuFFT
\item Hard to parallelize (note for later)
\end{itemize}
\column{0.5\textwidth}
\includegraphics[width=\textwidth]{radix-8screen.jpg}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Hamiltonian}
1D Schr\"odinger equation:
\begin{equation*}
i\hbar \frac{\partial \Psi(\mathbf{r}, t)}{\partial t} = \left(\frac{\hat p^2}{2m} + V_0(\mathbf{r}) \right)\Psi(\mathbf{r},t) = \mathcal{\hat H} \Psi(\mathbf{r},t)
\end{equation*}
\begin{columns}
\column{0.4\textwidth}
\pause
Splits into:
\begin{align*}
\mathcal{\hat H}_v &= V_0(\mathbf{r}) = \frac{1}{2}m\omega^2x^2\\
\mathcal{\hat H}_p &= \frac{\hat p^2}{2m}
\end{align*}
\column{0.6\textwidth}
\includegraphics[width=\textwidth]{SHO_2.pdf}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{The Split-Step Fourier Method}

Solution for $\Psi$:
\begin{equation*}
\Psi(\mathbf{r},t + dt) = \left[e^{-\frac{i\mathcal{\hat{H}}dt}{\hbar}}\right]\Psi(\mathbf{r},t) = \left[e^{-\frac{i(\mathcal{\hat{H}}_v + \mathcal{\hat{H}}_p)dt}{\hbar}}\right]\Psi(\mathbf{r},t)
\end{equation*}

\pause
Baker-Campbell-Hausdorff:
\begin{equation*}
\Psi(\mathbf{r},t+dt) = \left[e^{-\frac{i\mathcal{\hat{H}}_vdt}{\hbar}}e^{-\frac{i\mathcal{\hat{H}}_pdt}{\hbar}}e^{-\frac{[i\hat{H}_v, i\hat{H}_p]dt^2}{2}}\right]\Psi(\mathbf{r},t)
\end{equation*}

\pause
Strang splitting:
\begin{equation*}
\Psi(\mathbf{r},t+dt) = \left[e^{-\frac{i\mathcal{\hat{H}}_vdt}{2\hbar}}e^{-\frac{i\mathcal{\hat{H}}_pdt}{\hbar}}e^{-\frac{i\mathcal{\hat{H}}_vdt}{2\hbar}} \right]\Psi(\mathbf{r},t) + \mathcal{O}(dt^3)
\end{equation*}

\end{frame}

\begin{frame}
\frametitle{The Split-Step Fourier Method}
\begin{equation*}
\Psi(\mathbf{r}, t+dt) = \left[\hat{U}_r(dt)\mathcal{F}^{-1}\left[\hat{U}_p(dt) \mathcal{F} \left[\hat{U}_r(dt) \Psi(\mathbf{r},t) \right] \right] \right] + \mathcal{O}(dt^3)
\end{equation*}

\begin{columns}
\column{0.5\textwidth}
\begin{align*}
\hat{U}_r &= e^{-\frac{i\mathcal{\hat{H}}_vdt}{2\hbar}} \\
\hat{U}_p &= e^{-\frac{i\mathcal{\hat{H}}_pdt}{\hbar}}
\end{align*}
\column{0.5\textwidth}
\includegraphics[width=\textwidth]{../data/splitop/method/split_op_method.pdf}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Bose-Einstein condensation}
Bosons condense into a superfluid at 0 Kelvin

\begin{center}
\includegraphics[width=0.5\textwidth]{Bose_Einstein_condensate.png}

\tiny{NIST/JILA/CU-Boulder}
\end{center}

\pause

Described by the Gross--Pitaevskii equation:
\begin{equation*}
    i\hbar \frac{\partial}{\partial t}\Psi(\mathbf{r},t) = \left( - \frac{\hbar^2}{2m} \nabla^2 + V_0(\mathbf{r}) + {\color{red}{g |\Psi(\mathbf{r},t)|^2}}\right)\Psi(\mathbf{r},t).
\end{equation*}


\end{frame}

\begin{frame}
\frametitle{Superfluid rotation}
\center Rotation leads to many vortices in a triangular lattice
\vspace{0.25cm}

\begin{columns}
\column{0.45\textwidth}
\includegraphics[width=\textwidth]{vortex.jpg}
\tiny{Credit: howstuffworks.com}
\column{0.1\textwidth}
\center{\huge $\rightarrow$}
\column{0.45\textwidth}
\includegraphics[width=\textwidth]{vortexlattice.jpg}
\tiny{Credit: Peter Engels, JILA}
\end{columns}

\pause
\vspace{0.25cm}
Note: Vortices must follow axis of rotation
\end{frame}

\begin{frame}
\frametitle{Superfluid vortex phase}
\center \includegraphics[width=0.8\textwidth]{../data/splitop/rot/WIP.pdf}

Each vortex has a $2\pi$ complex phase winding
\end{frame}

\begin{frame}
\frametitle{Phase imprinting}
\center \includegraphics[width=0.75\textwidth]{../data/2d/phase/phase}


Phase masks can induce dynamical vortices

\end{frame}

\begin{frame}
\frametitle{Artificial magnetic fields}
\begin{center}
Magnetic fields cause rotation in \textit{charged} particles
\end{center}
\begin{columns}
\column{0.7\textwidth}
\begin{itemize}
\onslide<2->
\item If a two-level atom moves slowly in a tuned light field, \textit{Berry's connection} is
$$
\mathbf{A} = i\hbar\braket{\psi_l | \nabla\psi_l}
$$
\item The magnetic field is
$$
\mathbf{B} = \nabla \times \mathbf{A}
$$
\onslide<3->
\item Vortices follow the magnetic field lines
\end{itemize}
\onslide<2->
\column{0.3\textwidth}
\includegraphics[width=\textwidth]{2level.jpg}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Modifications to the GPE}
With gauge fields, the GPE becomes
\begin{equation*}
\mathcal{\hat H} = \frac{(p-{\color{red}{m\mathbf{A}}} )^2}{2m} + V_0 + g|\Psi(\mathbf{r},t)|^2
\end{equation*}

\onslide<2->
Which creates

\begin{columns}
\column{0.5\textwidth}
\onslide<2->
\begin{itemize}
\item A position-space component that couples with the trap
$$
\frac{m\mathbf{A}^2}{2}
$$

\onslide<3->
\item Components in position and momentum-space, that \textbf{require 1D FFT's}
$$
-\left(\frac{p\mathbf{A} + \mathbf{A}p}{2}\right)
$$
\end{itemize}
\onslide<2->
\column{0.55\textwidth}
\includegraphics[width=1.1\textwidth]{../data/splitop/gauge/check.pdf}
\end{columns}

\end{frame}

\begin{frame}
\center \huge Quantum state engineering
\end{frame}

\begin{frame}
\frametitle{Quantum optimal control}
Overall goal: optimize cost function by twiddling control parameters
\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\pause
\item Many known methods, such as \textbf{gradient descent}, \textbf{genetic algorithms}, and \textbf{machine learning}
\pause
\item For quantum systems, cost function is often the fidelity:
$$
\mathcal{F}= |\braket{\psi|\phi}|^2
$$
which required re-simulation every time a control parameter is changed
\end{itemize}
\pause
\column{0.5\textwidth}
\begin{center}
Nelder--Mead
\end{center}
\includegraphics[width=\textwidth]{../data/1d/NM/NM.pdf}

\begin{center}
ADD ANIMATION
\end{center}

\end{columns}
\end{frame}

\begin{frame}
\frametitle{Shortcuts to Adiabaticity}

\center \Huge{HELP}
\end{frame}

\begin{frame}
\frametitle{Example Tonks--Girardeau gas system}

\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item NOON state: $\ket{N,0}+\ket{0,N}$

\item Tonks--Girardeau Gas: $g \rightarrow \infty$
\end{itemize}
\column{0.5\textwidth}
\begin{center}
\includegraphics[width = 0.7\textwidth]{../data/1d/scheme.pdf}
\end{center}
\end{columns}

\pause

\includegraphics[width = 0.49\textwidth]{../data/1d/cross.png}
\includegraphics[width = 0.49\textwidth]{../data/1d/nocross.png}
\end{frame}

\begin{frame}
\frametitle{CRAB method}

An example protocol is the Chopped RAndom Basis (CRAB) optimal control method where...

\begin{itemize}
\item A control parameter is modified with
$$
\Gamma^{\text{CRAB}}(t) = \Gamma^0(t)\gamma(t)
$$
where
$$
\gamma(t)=1+\frac{1}{\lambda(t)}\sum_{j=1}^J(A_j \sin(\nu_jt) + B_j\cos(\nu_jt))
$$
\item Works if $\lim_{t\rightarrow 0} \lambda(t) = \lim_{t\rightarrow T}\lambda(t) = \infty$
\item Creates a $3J$-dimensional space to optimize ($A, B, \nu$)
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{STA protocol}
\includegraphics[width=\textwidth]{../data/1d/STAscheme.png}
\end{frame}

\begin{frame}
\frametitle{NOON optimization}

\begin{columns}
\column{0.5\textwidth}
\center Optimal control
\column{0.5\textwidth}
\center STA
\end{columns}

\begin{columns}
\column{0.5\textwidth}
\center \includegraphics[width=0.8\textwidth]{../data/1d/figlfid.pdf}
\column{0.5\textwidth}
\center \includegraphics[width=\textwidth]{../data/1d/fig6.png}
\end{columns}

\center Please ask questions at the end!
\end{frame}


\begin{frame}
\center \huge GPU computing and the GPUE codebase
\end{frame}

\begin{frame}
\frametitle{What is a GPU?}

\begin{columns}
\column{0.7\textwidth}
\begin{itemize}
\item Massively parallel computing device
\onslide<2->
\item Computing threads in blocks, blocks in grids
\onslide<3->
\item Memory coalescence
\onslide<4->
\item Data transfer is slow
\onslide<5->
\item Recursion and iteration is slow
\onslide<6->
\item Limited memory
\end{itemize}

\onslide<3->
\includegraphics[width=\textwidth]{../data/gpu/coalesce/check.pdf}

\column{0.3\textwidth}
\onslide<1->
\includegraphics[width=\textwidth]{v100.png}

\onslide<2->
\includegraphics[width=\textwidth]{../data/gpu/gputhreads.pdf}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{FFT notes}
\begin{columns}
\column{0.4\textwidth}
\begin{itemize}
\item Global operations
\item 1D FFT's are not supported by CuFFT
\item Transposes are necessary
\end{itemize}
\center \includegraphics[width=\textwidth]{../data/gpu/fft/fft_fig.png}

\column{0.7\textwidth}
\center \includegraphics[width=\textwidth]{../data/gpu/fft/fft_fig2.png}
\end{columns}

\end{frame}

\begin{frame}
\frametitle{Expression trees}

\center \includegraphics[width=0.6\textwidth]{expr_tree.png}

\begin{itemize}
\item Allows for quantum state engineering
\item Saves GPU memory
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Vortex tracking and highlighting}
\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item Phase plaquettes in 2D
\onslide<2->
\item Vortex highlighting in 3D
\end{itemize}
\onslide<2->
\center \includegraphics[width=1.2\textwidth]{../data/gpu/vortex_highlighting/all.png}
\column{0.5\textwidth}

\onslide<1->
\center \includegraphics[width = 0.8\textwidth]{../data/gpu/vortex_tracking/phi_grid.png}

\end{columns}
\end{frame}

\begin{frame}
\center \huge Chaotic vortex dynamics in 2D BEC simulations
\end{frame}

\begin{frame}
\frametitle{3 vortex, 1 anti-vortex}
\includegraphics[width=\textwidth]{../data/2d/histogram/histogram}

\end{frame}

\begin{frame}
\frametitle{dynamics}
\center \includemovie[autoplay,repeat, poster]{9.55cm}{4.5cm}{chaos.mp4}
\end{frame}

\begin{frame}
\frametitle{Divergence in trajectories}
\begin{columns}

\column{0.6\textwidth}
Divergence in trajectory when Lyapunov exp ($\lambda$) becomes positive
$$
|\delta\mathbf{P}(t)| \approx e^{\lambda t} |\delta \mathbf{P}_0|
$$
$$
\lambda = \lim_{t\to\infty}\frac{1}{t}\text{ln}\frac{||\delta\textbf{P}(t)||}{||\delta\textbf{P}(0)||}
$$

\column{0.4\textwidth}
\includegraphics[width=\textwidth]{../data/2d/evolution/evolution}

\includegraphics[width=\textwidth]{../data/2d/lyap/lyap}
\end{columns}
\end{frame}

\begin{frame}
\center \huge 3D vortex ring generation in toroidal BEC systems
\end{frame}

\begin{frame}
\frametitle{The system}

\begin{columns}

\column{0.5\textwidth}
\begin{itemize}
\item BEC toroidally trapped around nanofiber
\item Nanofiber generates $\mathbf{A}$
\item Vortices follow $\mathbf{B} = \nabla \times \mathbf{A}$
\end{itemize}

\column{0.5\textwidth}
\includegraphics[width=\textwidth]{../data/3d/Schematic_TB}
\end{columns}

\end{frame}

\begin{frame}
\frametitle{Optical nanofiber}
\center \includegraphics[width=0.8\textwidth]{../data/3d/all_fields.pdf}

$$
\mathbf{A} = \hat{z} \hbar \kappa_0 (n_1 + 1) \tilde{s} \left[\frac{|d_rE_r + d_{\phi}E_{\phi} + d_zE_z|^2}{1 + \tilde s^2|d_rE_r + d_{\phi}E_{\phi} + d_zE_z|^2} \right]
$$
\end{frame}

\begin{frame}
\frametitle{Vortex structures}
\includegraphics[width=\textwidth]{../data/3d/vortex_transition.png}
\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item Transition with linear polarization
\item Vortex structures align with $\mathbf{B}$
\end{itemize}
\column{0.5\textwidth}
\center \includegraphics[width=\linewidth]{../data/3d/HE21_3d.png}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Interesting notes}

\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item A vortex ring lattice can be generated with high $\mathbf{B}$
\onslide<2->
\item Scissors modes can be used to detect vortices
\end{itemize}
\onslide<2->
\includegraphics[width=\textwidth]{../data/3d/scissors_plot.pdf}
\column{0.5\textwidth}
\onslide<1->
\includegraphics[width=\linewidth]{../data/3d/vortex_line_all.pdf}
\end{columns}
\end{frame}


\begin{frame}
\center \huge Overall conclusions
\end{frame}

\begin{frame}
\frametitle{Overall conclusions}

\begin{itemize}
\item The SSFM is nice
\item Quantum state engineering is cool
\item GPU computing is fast
\item We can create chaos
\item We can create not-chaos
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{People}
\begin{itemize}
\item Collaborators: Lee, Rashi, Angela, TT, Andreas, Peter, Albert, Jeremie, Ben, Irina, \textbf{Thomas}
\item Sponsors: JSPS, OIST, SCDA
\item Other: AAA
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Conclusions}
\end{frame}

\begin{frame}
\frametitle{Fidelities with optimal control}
\begin{columns}
\column{0.3\textwidth}
\begin{itemize}
\onslide<1->
\item Rotation ($\Omega(t)$)
\onslide<2->
\item Barrier height ($b(t)$)
\onslide<3->
\item Both
\end{itemize}
\column{0.7\textwidth}
\onslide<1->\includegraphics[width=.49\textwidth]{../data/1d/figR0.pdf}
\onslide<2->\includegraphics[width=.49\textwidth]{../data/1d/figB0.pdf}

\end{columns}

\begin{columns}
\column{0.3\textwidth}
\onslide<4->
\includegraphics[width=1.2\textwidth]{../data/1d/figlfid.pdf}
\column{0.7\textwidth}
\onslide<3->
\includegraphics[width=.49\textwidth]{../data/1d/figR1.pdf}
\includegraphics[width=.49\textwidth]{../data/1d/figB1.pdf}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{NOON Optimization}
Optimizations of NOON state generation with 3 and 5 particles
\begin{center}
\includegraphics[width=0.49\textwidth]{../data/1d/figTG3.pdf}
\includegraphics[width=0.49\textwidth]{../data/1d/figTG5.pdf}
\end{center}
\end{frame}

\begin{frame}
\frametitle{STA protocol}
\includegraphics[width=\textwidth]{../data/1d/STAscheme.png}
\end{frame}

\begin{frame}
\frametitle{STA fidelities}
\begin{columns}
\column{0.5\textwidth}

\begin{itemize}
\onslide<1->
\item Fidelities with rotation
\onslide<2->
\item Fidelities with rotation of 100, 200 and higher particle number
\end{itemize}
\column{0.5\textwidth}
\onslide<1->
\includegraphics[width=\textwidth]{../data/1d/fig6.png}

\end{columns}

\onslide<2->
\begin{columns}
\column{0.5\textwidth}
\includegraphics[width=\textwidth]{../data/1d/fig7a.png}
\column{0.5\textwidth}

\includegraphics[width=\linewidth]{../data/1d/fig7b.png}
\end{columns}

\end{frame}

\end{document}
